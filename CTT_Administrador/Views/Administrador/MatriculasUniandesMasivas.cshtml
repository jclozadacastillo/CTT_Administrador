@{
    ViewData["Title"] = "Matriculas Masivas Uniandes";
    Layout = "~/Views/Shared/_LayoutAdministrador.cshtml";
}

<div class="container-fluid" id="content" hidden>
    <div class="row">
        <div class="col-auto me-0 pe-0 form-title">
            <h4>Matriculas Masivas Uniandes</h4>
        </div>
        <div class="col-auto ">
            @* <button class="btn btn-sm btn-primary btn-new" title="Nuevo registro" onclick="nuevo()">
            <i class="bi-plus"></i> Agregar</button> *@
            <a class="btn btn-primary btn-sm" target="_blank" href="~/resources/plantilla_matriculas_uniandes.xlsx">
                <i class="bi-file-excel me-1"></i> Plantilla
            </a>
        </div>
    </div>
    <hr>

    <form id="frmDatos" enctype="multipart/form-data">
        <div class="row">
            <div class="col-sm-4">
                <label class="fs-sm">Periodo</label>
                <select class="form-select form-select-sm" id="idPeriodo" name="idPeriodo" onchange="comboTiposCursos()">
                    <option value="">Seleccione</option>
                </select>
            </div>
            <div class="col-sm-3">
                <label class="fs-sm">Tipo de curso</label>
                <select class="form-select form-select-sm" id="idTipoCurso" name="idTipoCurso" onchange="comboCursos()">
                    <option value="">Seleccione un periodo</option>
                </select>
            </div>

            <div class="col-sm-5">
                <label class="fs-sm">Curso</label>
                <select class="form-select form-select-sm" id="idGrupoCurso" name="idGrupoCurso" onchange="comboModulos()">
                    <option value="">Seleccione un tipo de curso</option>
                </select>
            </div>
            <div class="col-sm-5">
                <label class="fs-sm">Módulo</label>
                <select class="form-select form-select-sm" id="idCurso" name="idCurso">
                    <option value="">Seleccione un curso</option>
                </select>
            </div>
            <div class="col-sm-2">
                <label class="fs-sm">Paralelo</label>
                <select class="form-select form-select-sm" id="paralelo" name="paralelo">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                </select>
            </div>
            <div class="col-sm-6">
                <label class="fs-sm">Subir excel con datos</label>
                <input type="file" class="form-control form-control-sm"
                       accept="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                       id="archivo" name="archivo">
            </div>
            <div class="col-sm-4 text-md-start text-center">
                </br>
                <button type="button" class="btn btn-secondary btn-sm mt-1" onclick="cargarDatos(true)">
                    <i class="bi-upload me-1"></i>Cargar
                </button>
                <button type="button" class="btn btn-sm btn-primary mt-1" onclick="generarMatriculas()" id="btnGenerar"
                        hidden>
                    <i class="bi-check me-1"></i>Generar Matriculas
                </button>
            </div>
        </div>
    </form>

    <div class="table-responsive-sm mt-3">
        <table class="table table-sm table-condensed w-100
            table-light table-hover table-custom" id="tableDatos"></table>
    </div>
</div>

<div class="modal fade" id="espere" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content" style="min-width:330px">
            <div class="modal-body" style="width:325px">
                <div>
                    <img src="~/lib/utilities/toast/img/logo-azul370.png" width="91" />
                </div>
                <div class="text-center fs-sm mt-2" style="font-size:13px">
                    Espere por favor...
                </div>
                <div class="text-center my-3">
                    <div class="spinner-border text-primary text-center"></div>
                </div>
                <div class="text-center fs-xxs text-danger fw-bold" style="font-size:11px">
                    <i class="bi-exclamation-triangle-fill me-1"></i> No cierre la ventana ni cancele el proceso
                </div>
            </div>

        </div>
    </div>
</div>

<script defer src="~/js/administrador/siteMatriculasUniandesMasivas.js?v=@DateTime.Now.Ticks"></script>